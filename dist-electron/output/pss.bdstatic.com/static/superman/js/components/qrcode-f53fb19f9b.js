F.module("superman:components/qrcode",function(require,exports,ctx){var login1;var $qrcodeWrapper=$("#s_qrcode_nologin");var $qrTooltip=$(".qrcode-tooltip");var $topFeed=$("#s_top_feed");var called=false;var bottom1="228px";var bottom2="184px";var bodyEl=$("#wrapper");var headEl=$("#head");var bodyHtmlEl=$("html, body");var windowEl=$(window);var scrollContext=null;var $scrollTarget=null;function shouldDisplayTopFeed(scrollTop){var session=window.s_session||{};if($("body").hasClass(
"s-hide-top-feed")){return false}if(session.index_off||session.index_guide){return false}var isDashboardMode=window.bds&&window.bds.comm&&window.bds.comm.dashboardSector;if(isDashboardMode){return scrollTop>100}return scrollTop>0}function shouldUseHeadScroll(){var bds=window.bds||{};var comm=bds.comm||{};var isDashboardMode=comm.dashboardSector;return isDashboardMode&&(bodyEl.hasClass("login-ai-dashboard-index")||bodyEl.hasClass("no-login-ai-dashboard-index"))}function getScrollContext(){
var needHeadScroll=shouldUseHeadScroll();if(!scrollContext||scrollContext.needHeadScroll!==needHeadScroll||!scrollContext.target||scrollContext.target.length===0){var target=needHeadScroll&&headEl.length?headEl:windowEl;scrollContext={needHeadScroll:needHeadScroll&&headEl.length,target:target}}return scrollContext}function animateScrollTop(value,duration){var ctx=getScrollContext();var target=ctx.needHeadScroll?ctx.target:bodyHtmlEl;var extraTarget=ctx.needHeadScroll?bodyHtmlEl:null;if(
extraTarget&&extraTarget[0]!==target[0]){extraTarget.stop().animate({scrollTop:value},duration)}target.stop().animate({scrollTop:value},duration)}function loadScript(cb){$.getScript(location.protocol+"//passport.baidu.com/passApi/js/wrapper.js?cdnversion="+(new Date).getTime(),function(){cb&&cb()})}function hoverHandler(){if(called){$qrTooltip.hide();called=false;return}ctx.fire("qrcodehover");called=true;$qrTooltip.show();if($(".qrcode-tooltip").children().length>2){return}loadScript(function(
){passport.use("login",{tangram:true,loginVersion:"v5",defaultCss:true},function(magic){login1=new magic.passport.login({product:"mn",loginType:1,qrcodeLogin:1,hasRegUrl:false,autosuggest:false,hasPlaceholder:false,u:window.document.location.href,staticPage:window.location.protocol+"//www.baidu.com/cache/user/html/v3Jump.html"});window.mmm=login1;login1.on("loginSuccess",function(evt){evt.returnValue=false;ctx.fire("qrcodeloginsuccess");setTimeout(function(){
window.document.location.href=window.document.location.href},500)});login1.on("render",function(){var success=$qrTooltip.find(".Qrcode-status-success > p.Qrcode-status-msg");var refresh=$qrTooltip.find(".Qrcode-status-refresh > p.refresh-timeout");var refreshIcon=$qrTooltip.find(".Qrcode-status-refresh > p.Qrcode-status-icon");var error=$qrTooltip.find(".Qrcode-status-error > p.Qrcode-status-icon+p");var errorIcon=$qrTooltip.find(".Qrcode-status-error > p.Qrcode-status-icon");$(refreshIcon
).addClass("c-icon").html("&#xe622;");$(errorIcon).addClass("c-icon").html("&#xe622;");var text=$qrTooltip.find(".Qrcode-status-success > p.Qrcode-status-icon+p");$(success).hide();text.innerText="扫码成功";refresh.innerText="二维码失效";error.innerText="加载失败";$(".refresh-loadout").text("加载失败").css({color:"#9195a3"})});login1.render("qrcode-login-wrapper")})})}exports.init=function(){$qrcodeWrapper.hover(hoverHandler);loadScript();if($qrcodeWrapper.length&&$topFeed.length){var scrollHandler=function(){
var ctx=getScrollContext();var allowShow=shouldDisplayTopFeed(ctx.target.scrollTop());var isOpen=$topFeed.hasClass("is-open");if(allowShow&&!isOpen){$topFeed.addClass("is-open");$topFeed.find(".to-top").css({visibility:"visible"});$("#s_popup_advert").find(".advert-shrink").css({bottom:bottom1,transition:"none","-webkit-transition":"none","-moz-transition":"none","-o-transition":"none"})}else if(!allowShow&&isOpen){$topFeed.removeClass("is-open");$topFeed.find(".to-top").css({visibility:"hidden"
});$("#s_popup_advert").find(".advert-shrink").css({bottom:bottom2,transition:"none","-webkit-transition":"none","-moz-transition":"none","-o-transition":"none"})}else{}};var bindScrollTarget=function(){var ctx=getScrollContext();if($scrollTarget&&$scrollTarget.length){$scrollTarget.off("scroll",scrollHandler)}$scrollTarget=ctx.target;$scrollTarget.on("scroll",scrollHandler)};bindScrollTarget();windowEl.on("resize",bindScrollTarget);scrollHandler();$topFeed.on("click",".to-top",function(e){
e.preventDefault();animateScrollTop(0,300)}).on("mouseenter mouseleave",".to-top",function(e){$(this).toggleClass("icon-over",e.type==="mouseenter")})}}});F.addLog("superman:components/qrcode",["qrcodehover"]);F.addLog("superman:components/qrcode",["qrcodeloginsuccess"]);